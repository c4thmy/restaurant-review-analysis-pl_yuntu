# API密钥申请详细指南

## 🎯 概述

本指南将手把手教您申请三大地图平台的API密钥，让您能够获取真实的餐厅数据。所有平台都提供丰富的免费额度，足够一般使用需求。

---

## 🗺️ 高德地图API申请指南

### 免费额度
- **每日调用量**: 30万次
- **并发QPS**: 200次/秒
- **适用场景**: 高频率数据获取

### 申请步骤

#### 1. 注册开发者账号
1. **访问官网**: https://lbs.amap.com/
2. **点击右上角"注册"**
3. **选择注册方式**:
   - 手机号注册（推荐）
   - 邮箱注册
4. **填写基本信息**:
   - 真实姓名
   - 手机号码
   - 验证码
5. **完成注册并登录**

#### 2. 实名认证（重要）
1. **进入控制台**: 登录后点击"控制台"
2. **点击"实名认证"**
3. **选择认证类型**:
   - **个人认证**（推荐新手）
     - 上传身份证正反面
     - 填写姓名和身份证号
     - 1-3个工作日审核
   - **企业认证**
     - 营业执照
     - 对公账户验证

#### 3. 创建应用
1. **进入应用管理**: 控制台 → 应用管理 → 我的应用
2. **点击"创建新应用"**
3. **填写应用信息**:
   ```
   应用名称: 餐厅数据分析系统
   应用类型: Web服务
   应用描述: 用于餐厅位置信息查询和数据分析
   ```

#### 4. 申请API服务
1. **在应用中点击"添加Key"**
2. **选择服务类型**: **Web服务API**
3. **填写Key信息**:
   ```
   Key名称: RestaurantSearchKey
   绑定服务:
     ✅ 搜索POI
     ✅ 地理编码
     ✅ 逆地理编码
   ```
4. **提交申请，立即生效**

#### 5. 获取API Key
```
Key格式: 32位字符串
示例: your_amap_api_key_here
复制保存备用
```

---

## 🟦 百度地图API申请指南

### 免费额度
- **每日调用量**: 10万次
- **并发QPS**: 100次/秒
- **适用场景**: 中等频率使用

### 申请步骤

#### 1. 注册百度账号
1. **访问官网**: https://lbsyun.baidu.com/
2. **点击"注册"**
3. **使用手机号或邮箱注册**
4. **完成手机验证**

#### 2. 开发者认证
1. **登录后点击"控制台"**
2. **首次使用需要开发者认证**
3. **填写开发者信息**:
   ```
   开发者类型: 个人开发者（推荐）
   真实姓名: [您的真实姓名]
   身份证号: [身份证号码]
   手机号: [注册手机号]
   ```
4. **上传身份证照片**
5. **等待1-2个工作日审核**

#### 3. 创建应用
1. **进入"应用管理"**
2. **点击"创建应用"**
3. **填写应用信息**:
   ```
   应用名称: 餐厅信息查询系统
   应用类型: 服务端
   启用服务:
     ✅ Place API（地点检索）
     ✅ 地理编码API
   白名单: 0.0.0.0/0 (允许任意IP)
   ```

#### 4. 获取AK (Access Key)
```
AK格式: 24位字符串
示例: your_baidu_api_key_here
在应用详情页面可以看到
```

---

## 🟢 腾讯位置服务API申请指南

### 免费额度
- **每日调用量**: 1万次
- **并发QPS**: 50次/秒
- **适用场景**: 轻量级使用

### 申请步骤

#### 1. 注册腾讯云账号
1. **访问官网**: https://lbs.qq.com/
2. **点击"立即使用"**
3. **用QQ或微信登录**（推荐）
4. **或注册新的腾讯云账号**

#### 2. 实名认证
1. **进入控制台**
2. **点击右上角头像 → 账号信息**
3. **进行实名认证**:
   - **个人认证**: 身份证 + 人脸识别
   - **企业认证**: 营业执照验证

#### 3. 开通位置服务
1. **返回位置服务控制台**: https://console.cloud.tencent.com/lbs
2. **首次使用需要开通服务**
3. **同意服务协议**
4. **选择付费模式**: 按量付费（有免费额度）

#### 4. 创建应用
1. **进入"应用管理"**
2. **点击"创建应用"**
3. **填写应用信息**:
   ```
   应用名称: 餐厅数据分析应用
   应用类型: WebServiceAPI
   域名白名单: * (允许所有域名)
   ```

#### 5. 配置API服务
1. **在应用中点击"添加Key"**
2. **勾选需要的服务**:
   ```
   ✅ 地点搜索
   ✅ 关键词输入提示
   ✅ 地址解析
   ```
3. **设置配额**: 使用默认配额即可

#### 6. 获取Key
```
Key格式: 32位字符串
示例: ABCDE-FGHIJ-KLMNO-PQRST-UVWXY-ZABCD-EFGHI
在密钥管理页面获取
```

---

## ⚙️ 配置API密钥

### 1. 编辑配置文件
打开 `@cc-code/api_keys_template.json` 文件：

```json
{
  "amap": "填入您的高德地图API Key",
  "baidu": "填入您的百度地图AK",
  "tencent": "填入您的腾讯地图Key"
}
```

### 2. 实际配置示例
```json
{
  "amap": "your_amap_api_key_here",
  "baidu": "your_baidu_api_key_here",
  "tencent": "your_tencent_api_key_here"
}
```

---

## 🧪 验证API密钥

我为您创建了一个密钥验证工具，确保您的API密钥配置正确：

### 自动验证工具
```bash
cd @cc-code
python ccc-api_key_validator.py
```

这个工具会：
- ✅ 自动检测您的API密钥配置
- ✅ 测试每个平台的连接和权限
- ✅ 提供详细的错误诊断和建议
- ✅ 生成验证报告供后续参考

### 手动测试方法
如果您想手动验证，可以使用以下测试URL：

#### 高德地图测试
```
https://restapi.amap.com/v3/place/text?key=您的密钥&keywords=麦当劳&city=北京
```

#### 百度地图测试
```
https://api.map.baidu.com/place/v2/search?ak=您的密钥&query=肯德基&region=北京&output=json
```

#### 腾讯地图测试
```
https://apis.map.qq.com/ws/place/v1/search?key=您的密钥&keyword=星巴克&boundary=region(北京,0)
```

---

## 💰 费用说明

### 免费额度对比
| 平台 | 每日免费调用 | 适用场景 | 超额收费 |
|------|-------------|----------|----------|
| 高德地图 | 30万次 | 大规模数据获取 | ¥1-3/千次 |
| 百度地图 | 10万次 | 中等规模使用 | ¥1-5/千次 |
| 腾讯地图 | 1万次 | 轻量级测试 | ¥1-4/千次 |

### 成本预估
```python
# 假设您每天要搜索100个关键词，每个关键词获取20家餐厅
daily_calls = 100 * 3  # 100个关键词 × 3个平台
monthly_calls = daily_calls * 30  # 9000次/月

# 推荐配置：
# 高德地图: 主要平台（70%流量）
# 百度地图: 补充平台（20%流量）
# 腾讯地图: 备用平台（10%流量）
```

---

## ⚠️ 重要注意事项

### 1. 密钥安全
- 🔒 **不要在代码中硬编码API密钥**
- 🔒 **使用配置文件或环境变量存储**
- 🔒 **不要将密钥提交到公开代码仓库**
- 🔒 **定期更换API密钥**

### 2. 使用限制
- ⏱️ **遵守QPS限制**，避免请求过于频繁
- 📊 **监控配额使用**，避免意外超额收费
- 🌐 **配置IP白名单**，增强安全性
- 📝 **遵守使用协议**，仅用于合法用途

### 3. 最佳实践
- 💾 **实现请求缓存**，避免重复调用
- 🔄 **使用重试机制**，处理网络异常
- 📈 **监控API状态**，及时发现问题
- 🛡️ **错误处理**，保证系统稳定性

---

## 🚀 快速开始流程

### 步骤1: 选择平台申请（建议全部申请）
```
时间投入: 每个平台约15-30分钟
难度: ⭐⭐ (中等)

推荐顺序:
1. 高德地图 (额度最大)
2. 百度地图 (功能丰富)
3. 腾讯地图 (腾讯生态)
```

### 步骤2: 完成认证
```
个人认证: 1-3个工作日
企业认证: 3-7个工作日

必需材料:
✅ 身份证照片 (个人)
✅ 营业执照 (企业)
✅ 真实手机号
✅ 有效邮箱
```

### 步骤3: 配置和测试
```bash
# 1. 编辑密钥配置
nano api_keys_template.json

# 2. 验证密钥有效性
python ccc-api_key_validator.py

# 3. 运行真实数据获取
python ccc-api_data_pipeline.py
```

### 步骤4: 开始使用
```python
# 立即可用的完整示例
from ccc_api_data_pipeline import OfficialAPIDataProcessor

processor = OfficialAPIDataProcessor('api_keys_template.json')
results = processor.run_full_pipeline("火锅", "北京", 20)

print(f"获取到 {len(results['restaurants'])} 家餐厅数据")
```

---

## 📞 技术支持

### 官方技术支持
- **高德地图**: https://lbs.amap.com/dev/support
- **百度地图**: https://lbsyun.baidu.com/index.php?title=service/question
- **腾讯地图**: https://lbs.qq.com/service/support

### 常见问题自助解决
1. **API密钥无效** → 检查复制是否完整，确认服务已开通
2. **调用失败** → 查看错误代码，参考官方文档
3. **配额不足** → 登录控制台查看使用情况
4. **网络超时** → 检查网络连接，考虑增加重试

### 紧急联系方式
如遇到紧急问题，可以：
- 查看官方状态页面
- 联系平台客服
- 在开发者论坛求助
- 暂时切换到其他平台

---

## 📈 进阶优化

### 多平台智能调度
```python
# 根据平台特点智能分配请求
platform_strategy = {
    'amap': {
        'weight': 0.7,  # 70%请求分配给高德
        'speciality': '详细POI信息'
    },
    'baidu': {
        'weight': 0.2,  # 20%分配给百度
        'speciality': '丰富的评分数据'
    },
    'tencent': {
        'weight': 0.1,  # 10%分配给腾讯
        'speciality': '位置精度高'
    }
}
```

### 成本优化策略
```python
# 智能缓存策略
cache_rules = {
    'restaurant_info': '7天',     # 餐厅基本信息缓存7天
    'location_search': '1天',     # 位置搜索缓存1天
    'popular_queries': '12小时'   # 热门查询缓存12小时
}
```

---

*指南更新时间: 2024年10月16日*
*适用版本: 最新API版本*